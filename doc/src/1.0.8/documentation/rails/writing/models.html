<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <title>RSpec-1.0.8: Models</title>
    <link href="../../../default.css" rel="stylesheet" type="text/css" media="screen"/>
    <link href="../../../breadcrumbs.css" rel="stylesheet" type="text/css" media="screen"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="description" content="RSpec, Models, BDD, behaviour driven development, behavior driven development, TDD, test driven development, Ruby, Rails, testing, watir, selenium"/>
    <style><!--
    div.breadcrumbs ul li {
    	background-image: url(../../../images/arrow.gif);
    }
    --></style>
  </head>
<body>

<div id="container">
  <div id="header">
    <h1>RSpec 1.0.8</h1>
  </div>

  <div class="breadcrumb-menu">
    <div class="breadcrumbs">
  <ul>
    <li><a href="../../../index.html">Home</a></li>
    <li><a href="../../index.html">Documentation</a></li>
    <li><a href="../index.html">Rails</a></li>
    <li><a href="index.html">Writing</a></li>
    <li class="selected"><span>Models</span></li>
  </ul>
</div>
<div class="menu">
  <ul>
  </ul>
</div>

  </div>

  <div id="content">
    <h2>Spec::Rails &#8211; Specifying Models</h2>


	<p>Model Examples live in $RAILS_ROOT/spec/models/ and provide access to fixtures.</p>


	<h2>Expectations</h2>


	<p>Model Examples support the following custom expectations.
See <a href="../../../rdoc-rails/index.html">Spec::Rails::Expectations</a> for more detail.</p>


	<h3>Records</h3>


<pre class="ruby"><code><span class="constant">Model</span><span class="punct">.</span><span class="ident">should</span> <span class="ident">have</span><span class="punct">(</span><span class="symbol">:no</span><span class="punct">).</span><span class="ident">records</span>
<span class="constant">Model</span><span class="punct">.</span><span class="ident">should</span> <span class="ident">have</span><span class="punct">(</span><span class="number">1</span><span class="punct">).</span><span class="ident">record</span>
<span class="constant">Model</span><span class="punct">.</span><span class="ident">should</span> <span class="ident">have</span><span class="punct">(</span><span class="number">3</span><span class="punct">).</span><span class="ident">records</span>
</code></pre>

	<p>This is a shortcut for <code>Model.find(:all).length.should == 3</code>.</p>


	<h3>Errors</h3>


<pre class="ruby"><code><span class="ident">model</span><span class="punct">.</span><span class="ident">should</span> <span class="ident">have</span><span class="punct">(</span><span class="symbol">:no</span><span class="punct">).</span><span class="ident">errors_on</span><span class="punct">(</span><span class="symbol">:attribute</span><span class="punct">)</span>
<span class="ident">model</span><span class="punct">.</span><span class="ident">should</span> <span class="ident">have</span><span class="punct">(</span><span class="number">1</span><span class="punct">).</span><span class="ident">error_on</span><span class="punct">(</span><span class="symbol">:attribute</span><span class="punct">)</span>
<span class="ident">model</span><span class="punct">.</span><span class="ident">should</span> <span class="ident">have</span><span class="punct">(</span><span class="number">3</span><span class="punct">).</span><span class="ident">errors_on</span><span class="punct">(</span><span class="symbol">:attribute</span><span class="punct">)</span>
</code></pre>

	<h2>Sample Model Examples</h2>


<pre class="ruby"><code><span class="ident">require</span> <span class="constant">File</span><span class="punct">.</span><span class="ident">dirname</span><span class="punct">(</span><span class="constant">__FILE__</span><span class="punct">)</span> <span class="punct">+</span> <span class="punct">'</span><span class="string">/../spec_helper</span><span class="punct">'</span>

<span class="ident">describe</span> <span class="constant">Person</span><span class="punct">,</span> <span class="punct">&quot;</span><span class="string">with fixtures loaded</span><span class="punct">&quot;</span> <span class="keyword">do</span>
  <span class="ident">fixtures</span> <span class="symbol">:people</span><span class="punct">,</span> <span class="symbol">:animals</span>

  <span class="ident">before</span><span class="punct">(</span><span class="symbol">:each</span><span class="punct">)</span> <span class="keyword">do</span>
    <span class="comment"># fixtures are setup before this</span>
  <span class="keyword">end</span>

  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should have a non-empty collection of people</span><span class="punct">&quot;</span> <span class="keyword">do</span>
    <span class="constant">Person</span><span class="punct">.</span><span class="ident">find</span><span class="punct">(</span><span class="symbol">:all</span><span class="punct">).</span><span class="ident">should_not</span> <span class="ident">be_empty</span>
  <span class="keyword">end</span>

  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should have one record</span><span class="punct">&quot;</span> <span class="keyword">do</span>
    <span class="constant">Person</span><span class="punct">.</span><span class="ident">should</span> <span class="ident">have</span><span class="punct">(</span><span class="number">1</span><span class="punct">).</span><span class="ident">record</span>
  <span class="keyword">end</span>

  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should find an existing person</span><span class="punct">&quot;</span> <span class="keyword">do</span>
    <span class="ident">person</span> <span class="punct">=</span> <span class="constant">Person</span><span class="punct">.</span><span class="ident">find</span><span class="punct">(</span><span class="ident">people</span><span class="punct">(</span><span class="symbol">:lachie</span><span class="punct">).</span><span class="ident">id</span><span class="punct">)</span>
    <span class="ident">person</span><span class="punct">.</span><span class="ident">should</span> <span class="ident">eql</span><span class="punct">(</span><span class="ident">people</span><span class="punct">(</span><span class="symbol">:lachie</span><span class="punct">))</span>
  <span class="keyword">end</span>

  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should have animals</span><span class="punct">&quot;</span> <span class="keyword">do</span>
    <span class="ident">people</span><span class="punct">(</span><span class="symbol">:lachie</span><span class="punct">).</span><span class="ident">should</span> <span class="ident">have</span><span class="punct">(</span><span class="number">2</span><span class="punct">).</span><span class="ident">animals</span>
  <span class="keyword">end</span>

  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should include animals</span><span class="punct">&quot;</span> <span class="keyword">do</span>
    <span class="ident">people</span><span class="punct">(</span><span class="symbol">:lachie</span><span class="punct">).</span><span class="ident">should</span> <span class="ident">have</span><span class="punct">(</span><span class="number">2</span><span class="punct">).</span><span class="ident">animals</span>
    <span class="ident">people</span><span class="punct">(</span><span class="symbol">:lachie</span><span class="punct">).</span><span class="ident">animals</span><span class="punct">.</span><span class="ident">should</span> <span class="ident">include</span><span class="punct">(</span><span class="ident">animals</span><span class="punct">(</span><span class="symbol">:horse</span><span class="punct">))</span>
    <span class="ident">people</span><span class="punct">(</span><span class="symbol">:lachie</span><span class="punct">).</span><span class="ident">animals</span><span class="punct">.</span><span class="ident">should_not</span> <span class="ident">include</span><span class="punct">(</span><span class="constant">Animal</span><span class="punct">.</span><span class="ident">new</span><span class="punct">(</span><span class="symbol">:name=</span><span class="punct">&gt;'</span><span class="string">monkey</span><span class="punct">'))</span>
  <span class="keyword">end</span>

  <span class="ident">after</span><span class="punct">(</span><span class="symbol">:each</span><span class="punct">)</span> <span class="keyword">do</span>
    <span class="comment"># fixtures are torn down after this</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="ident">describe</span> <span class="constant">Person</span><span class="punct">,</span> <span class="punct">&quot;</span><span class="string">with a name</span><span class="punct">&quot;</span> <span class="keyword">do</span>
  <span class="ident">fixtures</span> <span class="symbol">:people</span>

  <span class="ident">before</span><span class="punct">(</span><span class="symbol">:each</span><span class="punct">)</span> <span class="keyword">do</span>
    <span class="attribute">@person</span> <span class="punct">=</span> <span class="constant">Person</span><span class="punct">.</span><span class="ident">new</span><span class="punct">(</span><span class="symbol">:name</span> <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">CheliDaveSlak and the Fabulous Baker Boy</span><span class="punct">&quot;)</span>
  <span class="keyword">end</span>

  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should be valid</span><span class="punct">&quot;</span> <span class="keyword">do</span>
    <span class="attribute">@person</span><span class="punct">.</span><span class="ident">should</span> <span class="ident">be_valid</span>
  <span class="keyword">end</span>

  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should have no errors after save</span><span class="punct">&quot;</span> <span class="keyword">do</span>
    <span class="attribute">@person</span><span class="punct">.</span><span class="ident">save</span><span class="punct">.</span><span class="ident">should</span> <span class="ident">be_true</span>
    <span class="attribute">@person</span><span class="punct">.</span><span class="ident">errors</span><span class="punct">.</span><span class="ident">should</span> <span class="ident">be_empty</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="comment"># Using context here for 2 reasons:</span>
<span class="comment">#   - to provide an example where it makes sense</span>
<span class="comment">#   - as a spec to prove that you can use context</span>
<span class="ident">context</span> <span class="constant">Person</span><span class="punct">,</span> <span class="punct">&quot;</span><span class="string">with 2 animals</span><span class="punct">&quot;</span> <span class="keyword">do</span>
  <span class="ident">before</span><span class="punct">(</span><span class="symbol">:each</span><span class="punct">)</span> <span class="keyword">do</span>
    <span class="attribute">@fluff</span> <span class="punct">=</span> <span class="constant">Animal</span><span class="punct">.</span><span class="ident">new</span><span class="punct">(</span><span class="symbol">:name</span> <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">fluff</span><span class="punct">&quot;,</span> <span class="symbol">:age</span> <span class="punct">=&gt;</span> <span class="number">7</span><span class="punct">)</span>
    <span class="attribute">@binki</span> <span class="punct">=</span> <span class="constant">Animal</span><span class="punct">.</span><span class="ident">new</span><span class="punct">(</span><span class="symbol">:name</span> <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">binki</span><span class="punct">&quot;,</span> <span class="symbol">:age</span> <span class="punct">=&gt;</span> <span class="number">0.5</span><span class="punct">)</span>
    <span class="attribute">@person</span> <span class="punct">=</span> <span class="constant">Person</span><span class="punct">.</span><span class="ident">new</span><span class="punct">(</span><span class="symbol">:name</span> <span class="punct">=&gt;</span> <span class="punct">&quot;</span><span class="string">David</span><span class="punct">&quot;)</span>
    <span class="attribute">@person</span><span class="punct">.</span><span class="ident">add_animal</span><span class="punct">(</span><span class="attribute">@fluff</span><span class="punct">)</span>
    <span class="attribute">@person</span><span class="punct">.</span><span class="ident">add_animal</span><span class="punct">(</span><span class="attribute">@binki</span><span class="punct">)</span>
  <span class="keyword">end</span>

  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should be able to tell you its pups</span><span class="punct">&quot;</span> <span class="keyword">do</span>
    <span class="attribute">@person</span><span class="punct">.</span><span class="ident">animals</span><span class="punct">.</span><span class="ident">pups</span><span class="punct">.</span><span class="ident">should</span> <span class="punct">==</span> <span class="punct">[</span><span class="attribute">@binki</span><span class="punct">]</span>
  <span class="keyword">end</span>

  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should be able to tell you its adults</span><span class="punct">&quot;</span> <span class="keyword">do</span>
    <span class="attribute">@person</span><span class="punct">.</span><span class="ident">animals</span><span class="punct">.</span><span class="ident">adults</span><span class="punct">.</span><span class="ident">should</span> <span class="punct">==</span> <span class="punct">[</span><span class="attribute">@fluff</span><span class="punct">]</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>
</code></pre>
    
    <div id="footer">
      Webdesign by <a href="http://www.oswd.org/user/profile/id/9462">JM</a>
      <SCRIPT type='text/javascript' language='JavaScript' src='http://www.ohloh.net/projects/4386;badge_js'></SCRIPT>
    </div>
  </div>
</div>

<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-1889510-1";
urchinTracker();
</script>
</body>
</html>