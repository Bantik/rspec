# We have to make sure the rspec lib above gets loaded rather than the gem one (in case it's installed)
dir = File.dirname(__FILE__)
$LOAD_PATH.unshift(File.expand_path("#{dir}/../../../rspec/lib"))
require 'spec/rake/spectask'
require "#{dir}/bootstrap_rspec"

namespace :rspec do
  task :pre_commit do
    bootstrap_rspec.pre_commit
  end

  task :install_plugin do
    bootstrap_rspec.install_plugin
  end

  task :uninstall_plugin do
    bootstrap_rspec.uninstall_plugin
  end

  desc "configures config/database.yml for mysql"
  task :generate_mysql_config do
    bootstrap_rspec.generate_mysql_config
  end

  desc "configures config/database.yml for sqlite3"
  task :generate_sqlite3_config do
    bootstrap_rspec.generate_sqlite3_config
  end

  desc "deletes config/database.yml"
  task :clobber_db_config do
    bootstrap_rspec.clobber_db_config
  end

  desc "deletes sqlite databases"
  task :clobber_sqlite_data do
    bootstrap_rspec.clobber_sqlite_data
  end

  desc "Generates temporary purchase files with rspec_resource"
  task :generate_purchase do
    bootstrap_rspec.generate_purchase
  end

  task :migrate_up do
    bootstrap_rspec.migrate_up
  end

  desc "Destroys temporary purchase files (generated by rspec_resource)"
  task :destroy_purchase do
    bootstrap_rspec.destroy_purchase
  end

  task :migrate_down do
    bootstrap_rspec.migrate_down
  end

  task :rm_generated_purchase_files do
    bootstrap_rspec.rm_generated_purchase_files
  end

  def bootstrap_rspec
    BootstrapRspec.new(self)
  end
end
