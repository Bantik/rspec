#!/usr/bin/env ruby

require 'ostruct'
require 'optparse'
require File.dirname(__FILE__) + "/../lib/spec/new_runner/text_runner"

class SpecOptionParser
  
  def self.parse(args)
    options = OpenStruct.new
    options.out = $stdout
    
    opts = OptionParser.new do |opts|
      opts.banner = "Usage: specdoc [options] DIRECTORY"
      opts.separator ""

      opts.on("-o", "--of [FILE]", "Set the output file (defaults to STDOUT)") do |outfile|
        options.out = File.open(outfile, 'w')
      end

      opts.on_tail("-h", "--help", "Show this message") do
        puts opts
        exit
      end
      
    end
    opts.parse!(args)
    options
  end
  
end

options = SpecOptionParser.parse(ARGV)
$spec_runner = Spec::NewTextRunner.new(options.out)

ARGV.each do |file|
  require file
end

$spec_runner.run
