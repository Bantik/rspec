<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <title>RSpec-1.0.8: Index</title>
    <link href="../default.css" rel="stylesheet" type="text/css" media="screen"/>
    <link href="../breadcrumbs.css" rel="stylesheet" type="text/css" media="screen"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="description" content="RSpec, Index, BDD, behaviour driven development, behavior driven development, TDD, test driven development, Ruby, Rails, testing, watir, selenium"/>
    <style><!--
    div.breadcrumbs ul li {
    	background-image: url(../images/arrow.gif);
    }
    --></style>
  </head>
<body>

<div id="container">
  <div id="header">
    <h1>RSpec 1.0.8</h1>
  </div>

  <div class="breadcrumb-menu">
    <div class="breadcrumbs">
  <ul>
    <li><a href="../index.html">Home</a></li>
    <li class="selected"><span>Documentation</span></li>
  </ul>
</div>
<div class="menu">
  <ul>
    <li><a href="tools/index.html">Tools</a></li>
    <li><a href="rails/index.html">Rails</a></li>
    <li><a href="mocks/index.html">Mocks</a></li>
    <li><a href="test_unit.html">Test::Unit Cheat Sheet</a></li>
    <li><a href="expectations.html">Expectations</a></li>
    <li><a href="before_and_after.html">Before and After</a></li>
    <li><a href="../coverage/index.html">RCov</a></li>
    <li><a href="../report.html">RSpec Report</a></li>
    <li><a href="../rdoc/index.html">RDoc</a></li>
  </ul>
</div>

  </div>

  <div id="content">
    <h2>Executable Examples</h2>


	<p>RSpec provides a Domain Specific Language with which you can express executable
examples of the expected behaviour of a system.</p>


	<p>Imagine that you were talking to a customer requesting software for her bank.
Part of that conversation might well look like this:</p>


<pre>
You:      Describe an account when it is first created.
Customer: It should have a balance of $0.
</pre>

	<p>Here&#8217;s how we express that conversation in RSpec:</p>


<pre class="ruby"><code><span class="ident">describe</span> <span class="constant">Account</span><span class="punct">,</span> <span class="punct">&quot;</span><span class="string"> when first created</span><span class="punct">&quot;</span> <span class="keyword">do</span>
  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should have a balance of $0</span><span class="punct">&quot;</span> <span class="keyword">do</span>
    <span class="punct">...</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>
</code></pre>

	<p>When you execute this example, RSpec can provide a report like this:</p>


<pre>
Account, when first created
- should have a balance of $0
</pre>

	<p>So we use RSpec to <code>#describe</code> <b>Behaviour</b> of a system using <b>Examples</b>
of how <code>#it</code> should work.</p>


	<h2>A Bit More Detail</h2>


	<p>Here&#8217;s how the example might look with some more code filled in:</p>


<pre class="ruby"><code><span class="ident">describe</span> <span class="constant">Account</span><span class="punct">,</span> <span class="punct">&quot;</span><span class="string"> when first created</span><span class="punct">&quot;</span> <span class="keyword">do</span>

  <span class="ident">before</span> <span class="keyword">do</span>
    <span class="attribute">@account</span> <span class="punct">=</span> <span class="constant">Account</span><span class="punct">.</span><span class="ident">new</span>
  <span class="keyword">end</span>

  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should have a balance of $0</span><span class="punct">&quot;</span> <span class="keyword">do</span>
    <span class="attribute">@account</span><span class="punct">.</span><span class="ident">balance</span><span class="punct">.</span><span class="ident">should</span> <span class="ident">eql</span><span class="punct">(</span><span class="constant">Money</span><span class="punct">.</span><span class="ident">new</span><span class="punct">(</span><span class="number">0</span><span class="punct">,</span> <span class="symbol">:dollars</span><span class="punct">))</span>
  <span class="keyword">end</span>

  <span class="ident">after</span> <span class="keyword">do</span>
    <span class="attribute">@account</span> <span class="punct">=</span> <span class="constant">nil</span>
  <span class="keyword">end</span>

<span class="keyword">end</span>
</code></pre>

	<p>The <code>#describe</code> method returns a <code>Behaviour</code> object, which represents
a particular behaviour of the system that you wish to describe. Technically,
a <code>Behaviour</code> is the equivalent of a fixture in xUnit-speak. It
is a metaphor for the context in which you will execute your example &#8211; a set of
known objects in a known starting state.</p>


	<p>The <code>#it</code> method returns an <code>Example</code> object, which represents
an example of the behaviour your are trying to describe.</p>


	<p>The <code>#before</code> and <code>#after</code> methods are just
like <code>#setup</code> and <code>#teardown</code> in xUnit. You use them to
set up the state <em>before</em> each example is executed, and tear down any
resources <em>after</em> each example.</p>


	<h4>#before and #after</h4>


	<p>You can use <code>#before</code> and/or <code>#after</code> to define
code that executes before and after each example or only once per Behaviour:</p>


<pre class="ruby"><code><span class="ident">describe</span> <span class="constant">Thing</span> <span class="keyword">do</span>
  <span class="ident">before</span><span class="punct">(</span><span class="symbol">:all</span><span class="punct">)</span> <span class="keyword">do</span>
    <span class="comment"># This is run once and only once, before all of the examples</span>
    <span class="comment"># and before any before(:each) blocks.</span>
  <span class="keyword">end</span>

  <span class="ident">before</span><span class="punct">(</span><span class="symbol">:each</span><span class="punct">)</span> <span class="keyword">do</span>
    <span class="comment"># This is run before each example.</span>
  <span class="keyword">end</span>

  <span class="ident">before</span> <span class="keyword">do</span>
    <span class="comment"># :each is the default, so this is the same as before(:each)</span>
  <span class="keyword">end</span>

  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should do stuff</span><span class="punct">&quot;</span> <span class="keyword">do</span>
    <span class="punct">...</span>
  <span class="keyword">end</span>

  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should do more stuff</span><span class="punct">&quot;</span> <span class="keyword">do</span>
    <span class="punct">...</span>
  <span class="keyword">end</span>

  <span class="ident">after</span><span class="punct">(</span><span class="symbol">:each</span><span class="punct">)</span> <span class="keyword">do</span>
    <span class="comment"># this is before each example</span>
  <span class="keyword">end</span>

  <span class="ident">after</span> <span class="keyword">do</span>
    <span class="comment"># :each is the default, so this is the same as after(:each)</span>
  <span class="keyword">end</span>

  <span class="ident">after</span><span class="punct">(</span><span class="symbol">:all</span><span class="punct">)</span> <span class="keyword">do</span>
    <span class="comment"># this is run once and only once after all of the examples</span>
    <span class="comment"># and after any after(:each) blocks</span>
  <span class="keyword">end</span>

<span class="keyword">end</span>
</code></pre>

	<p><b>Warning</b>: The use of <code>#before(:all)</code> and <code>#after(:all)</code> is
generally discouraged because it introduces dependencies between the Examples.
Still, it might prove useful for very expensive operations if you know what you are doing.</p>


	<h4>Helper Methods</h4>


	<p>You can write helper methods directly within a Behaviour:</p>


<pre class="ruby"><code><span class="ident">describe</span> <span class="punct">&quot;</span><span class="string">...</span><span class="punct">&quot;</span> <span class="keyword">do</span>

  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">...</span><span class="punct">&quot;</span> <span class="keyword">do</span>
    <span class="ident">helper_method</span>
  <span class="keyword">end</span>

  <span class="keyword">def </span><span class="method">helper_method</span>
    <span class="punct">...</span>
  <span class="keyword">end</span>

<span class="keyword">end</span>
</code></pre>

	<h4>Reusable Helper Methods</h4>


	<p>You can include helper methods in multiple Behaviours by expressing them within
a module, and then including that module in your Behaviour:</p>


<pre class="ruby"><code><span class="keyword">module </span><span class="module">AccountExampleHelperMethods</span>
  <span class="keyword">def </span><span class="method">helper_method</span>
    <span class="punct">...</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="ident">describe</span> <span class="punct">&quot;</span><span class="string">A new account</span><span class="punct">&quot;</span> <span class="keyword">do</span>
  <span class="ident">include</span> <span class="constant">AccountExampleHelperMethods</span>
  <span class="ident">before</span> <span class="keyword">do</span>
    <span class="attribute">@account</span> <span class="punct">=</span> <span class="constant">Account</span><span class="punct">.</span><span class="ident">new</span>
  <span class="keyword">end</span>

  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should have a balance of $0</span><span class="punct">&quot;</span> <span class="keyword">do</span>
    <span class="ident">helper_method</span>
    <span class="attribute">@account</span><span class="punct">.</span><span class="ident">balance</span><span class="punct">.</span><span class="ident">should</span> <span class="ident">eql</span><span class="punct">(</span><span class="constant">Money</span><span class="punct">.</span><span class="ident">new</span><span class="punct">(</span><span class="number">0</span><span class="punct">,</span> <span class="symbol">:dollars</span><span class="punct">))</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>
</code></pre>

	<h3>Shared behaviors</h3>


	<p>You can create shared behaviors and include those behaviors into other behaviors.</p>


	<p>Suppose you have some behavior that applies to all editions of your product, both large and small.</p>


	<p>First, factor out the &#8220;shared&#8221; behavior:</p>


<pre class="ruby"><code><span class="ident">describe</span> <span class="punct">&quot;</span><span class="string">AllEditions</span><span class="punct">&quot;,</span> <span class="symbol">:shared</span> <span class="punct">=&gt;</span> <span class="constant">true</span> <span class="keyword">do</span>
  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should behave like all editions</span><span class="punct">&quot;</span> <span class="keyword">do</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>
</code></pre>

	<p>then when you need define the behavior for the Large and Small editions, 
reference the shared behavior using the &#8216;it_should_behave_like&#8217; method.</p>


<pre class="ruby"><code><span class="ident">describe</span> <span class="punct">&quot;</span><span class="string">SmallEdition</span><span class="punct">&quot;</span> <span class="keyword">do</span>
  <span class="ident">it_should_behave_like</span> <span class="punct">&quot;</span><span class="string">AllEditions</span><span class="punct">&quot;</span>

  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should also behave like a small edition</span><span class="punct">&quot;</span> <span class="keyword">do</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="ident">describe</span> <span class="punct">&quot;</span><span class="string">LargeEdition</span><span class="punct">&quot;</span> <span class="keyword">do</span>
  <span class="ident">it_should_behave_like</span> <span class="punct">&quot;</span><span class="string">AllEditions</span><span class="punct">&quot;</span>

  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should also behave like a large edition</span><span class="punct">&quot;</span> <span class="keyword">do</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>
</code></pre>

	<p>it_should_behave_like will search for a Behavior by its description string, in this case, &#8220;AllEditions&#8221;</p>


	<p>All of the following are included from a shared behavior:</p>


	<ul>
	<li>before(:all)</li>
		<li>before(:each)</li>
		<li>after(:each)</li>
		<li>after(:all)</li>
		<li>any included modules</li>
	</ul>


	<p>Shared behaviors may not extend classes.</p>


	<p>Multiple shared behaviors may be referenced in one (non-shared) behaviour.</p>


	<p>Shared behaviours may be included in other shared behaviours:</p>


<pre class="ruby"><code><span class="ident">describe</span> <span class="punct">&quot;</span><span class="string">All Employees</span><span class="punct">&quot;,</span> <span class="symbol">:shared</span> <span class="punct">=&gt;</span> <span class="constant">true</span> <span class="keyword">do</span>
  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should be payable</span><span class="punct">&quot;</span> <span class="keyword">do</span>
    <span class="attribute">@employee</span><span class="punct">.</span><span class="ident">should</span> <span class="ident">respond_to</span><span class="punct">(</span><span class="symbol">:calculate_pay</span><span class="punct">)</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="ident">describe</span> <span class="punct">&quot;</span><span class="string">All Managers</span><span class="punct">&quot;,</span> <span class="symbol">:shared</span> <span class="punct">=&gt;</span> <span class="constant">true</span> <span class="keyword">do</span>
  <span class="ident">it_should_behave_like</span> <span class="punct">&quot;</span><span class="string">All Employees</span><span class="punct">&quot;</span>
  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should be bonusable</span><span class="punct">&quot;</span> <span class="keyword">do</span>
    <span class="attribute">@employee</span><span class="punct">.</span><span class="ident">should</span> <span class="ident">respond_to</span><span class="punct">(</span><span class="symbol">:apply_bonus</span><span class="punct">)</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="ident">describe</span> <span class="constant">Officer</span> <span class="keyword">do</span>
  <span class="ident">before</span><span class="punct">(</span><span class="symbol">:each</span><span class="punct">)</span> <span class="keyword">do</span>
    <span class="attribute">@employee</span> <span class="punct">=</span> <span class="constant">Officer</span><span class="punct">.</span><span class="ident">new</span>
  <span class="ident">new</span>
  <span class="ident">it_should_behave_like</span> <span class="punct">&quot;</span><span class="string">All Managers</span><span class="punct">&quot;</span>

  <span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should be optionable</span><span class="punct">&quot;</span> <span class="keyword">do</span>
    <span class="attribute">@employee</span><span class="punct">.</span><span class="ident">should</span> <span class="ident">respond_to</span><span class="punct">(</span><span class="symbol">:grant_options</span><span class="punct">)</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="global">$ </span><span class="ident">spec</span> <span class="ident">officer_spec</span><span class="punct">.</span><span class="ident">rb</span>

<span class="constant">Officer</span>
<span class="punct">-</span> <span class="ident">should</span> <span class="ident">be</span> <span class="ident">payable</span>
<span class="punct">-</span> <span class="ident">should</span> <span class="ident">be</span> <span class="ident">bonusable</span>
<span class="punct">-</span> <span class="ident">should</span> <span class="ident">be</span> <span class="ident">optionable</span>
</code></pre>

	<h3>Pending Examples</h3>


	<p>Beginning with rSpec-1.0, you may omit the block on an an example:</p>


<pre class="ruby"><code><span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should do something</span><span class="punct">&quot;</span>
</code></pre>

	<p>the summary report lists that example as not implemented.</p>


<pre class="ruby"><code><span class="number">37</span> <span class="ident">examples</span><span class="punct">,</span> <span class="number">0</span> <span class="ident">failures</span><span class="punct">,</span> <span class="number">1</span> <span class="keyword">not</span> <span class="ident">implemented</span>
</code></pre>

	<p>However, if you wish to have a body for your example, but still have
the example be marked as pending, use the #pending method:</p>


<pre class="ruby"><code><span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should do something</span><span class="punct">&quot;</span> <span class="keyword">do</span>
   <span class="ident">pending</span><span class="punct">(&quot;</span><span class="string">for some reason</span><span class="punct">&quot;)</span>
   <span class="constant">true</span><span class="punct">.</span><span class="ident">should</span> <span class="punct">==</span> <span class="constant">true</span>
<span class="keyword">end</span>
</code></pre>

	<p>Additionally, suppose you have a behaviour that exposes a known bug in
the system. For reasons beyond your control this bug will not be fixed
immediately, but you don&#8217;t want it failing your build. However, you
would like to be notified when the bug has been fixed.</p>


	<p>For this scenario, #pending optionally accepts a block.</p>


<pre class="ruby"><code><span class="ident">it</span> <span class="punct">&quot;</span><span class="string">should do something</span><span class="punct">&quot;</span> <span class="keyword">do</span>
   <span class="ident">pending</span><span class="punct">(&quot;</span><span class="string">for obvious reasons</span><span class="punct">&quot;)</span> <span class="keyword">do</span>
     <span class="constant">true</span><span class="punct">.</span><span class="ident">should</span> <span class="punct">==</span> <span class="constant">false</span>
   <span class="keyword">end</span>
<span class="keyword">end</span>
</code></pre>

	<p>If this block throws any exception, the example is still treated as
pending. However, if the block does not throw any exceptions, #pending
will raise a Spec::Expectations::ExpectationNotMetError alerting you
to the fact that something has changed.</p>
    
    <div id="footer">
      Webdesign by <a href="http://www.oswd.org/user/profile/id/9462">JM</a>
      <SCRIPT type='text/javascript' language='JavaScript' src='http://www.ohloh.net/projects/4386;badge_js'></SCRIPT>
    </div>
  </div>
</div>

<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-1889510-1";
urchinTracker();
</script>
</body>
</html>